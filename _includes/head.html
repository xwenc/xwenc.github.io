<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  {% seo %}
  <link rel="stylesheet" href="{{ "/assets/main.css" | relative_url }}">
  <script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
  <script type="text/javascript">
    $(document).ready(function(){
      function getQueryString(name) {
        var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');
        var r = window.location.search.substr(1).match(reg);
        if (r != null) {
            return unescape(r[2]);
        }
        return null;
      };

      function setActiveClass(tag) {
        var el = $("#tags");
        var list = el.find("li");
        list.each(function(){
          var text = $(this).find("a").text();
          if(text == tag) {
            $(this).addClass("active")
          }
        })
      };

      function renderPosts(data) {
        var el = $("#posts");
        var list = "";
        data.map(function(item,idx){
          var tags = item.tags ? " on  <a class='post-item-category' href='/?tag=" + item.tags + "' >" + item.tags + "</a>" : "";
          list +=
            "<section class='post-item'><header class='post-item-header'><p class='post-item-meta'>" 
            + "<span class='post-item-date'>" + item.date + "</span>"
            + tags 
            + "</p><h2 class='post-item-title'><a class='post-link' href='"
            + item.url
            + "'>" 
            + item.title
            + "</a></h2></header></section>";
        });
        el.html(list);
      };

      var dataStr = '{ {% for tag in site.tags %}{% if tag[0] != site.tags.first[0] %},{% endif %}"{{ tag[0] }}":[{% for post in tag[1] %}{% if post != tag[1].first %},{% endif %}{"url":"{{post.url}}", "title":"{{post.title}}", "date":"{{post.date | date: site.minima.date_format | default: "%b %-d, %Y"}}", "tags":"{{post.tags}}"}{% endfor %}]{% endfor %} }',
      data = JSON.parse(dataStr),
      curTag = getQueryString("tag"),
      archieves = data[curTag];

      if(curTag) {
        $(".pagination").remove();
      };

      setActiveClass(curTag);
      archieves && renderPosts(archieves);
    });   
  </script>
  {% feed_meta %}
  {% if jekyll.environment == 'production' and site.google_analytics %}
    {% include google-analytics.html %}
  {% endif %}
</head>
