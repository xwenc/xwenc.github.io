---
title: Webpack原理及使用技巧
layout: post
tags: frontend
---

webpack是一个打包模块化js的工具，可以通过loader转换文件，通过plugin扩展功能。

Demo: [https://github.com/xwenc-react/webpack-react-boilplate](https://github.com/xwenc-react/webpack-react-boilplate)

原理：
一切皆为模块，由于webpack并不支持除.js以外的文件，从而需要使用loader转换成webpack支持的模块，plugin用于扩展webpack的功能，在webpack构建生命周期的过程在合适的时机做了合适的事情。

1. 先了解一下Webpack从构建到输出文件结果的过程：解析配置参数，合并从shell传入和webpack.config.js文件的配置信息，输出最终的配置信息。
2. 注册配置中的插件，好让插件监听webpack构建生命周期中的事件节点，做出对应的反应。
3. 解析配置文件中entry入口文件，并找出每个文件依赖的文件，递归下去。
4. 在递归每个文件的过程中，根据文件类型和配置文件中loader找出相对应的loader对文件进行转换。
5. 递归结束之后得到每个文件最终的结果，根据entry配置生成代码chunk。
6. 输出所有chunk到文件系统。

* **官方文档**
[https://webpack.docschina.org/](https://webpack.docschina.org/)

* **中文教程**
[https://github.com/brickspert/blog/issues/1#hot-module-replacement](https://github.com/brickspert/blog/issues/1#hot-module-replacement)

* **webpack模块化原理-commonjs**
[https://segmentfault.com/a/1190000010349749](https://segmentfault.com/a/1190000010349749)

* **没有了CommonsChunkPlugin，咱拿什么来分包**
[https://segmentfault.com/a/1190000013476837](https://segmentfault.com/a/1190000013476837)

* **webpack4升级完全指南**
  [https://segmentfault.com/a/1190000014247030](https://segmentfault.com/a/1190000014247030)

  [https://github.com/taikongfeizhu/react-mobx-react-router4-boilerplate](https://github.com/taikongfeizhu/react-mobx-react-router4-boilerplate)

[https://github.com/taikongfeizhu/react-mobx-react-router4-boilerplate](https://github.com/taikongfeizhu/react-mobx-react-router4-boilerplate)

* **Github Demo**
[https://github.com/jdf2e/webpack4-demo/blob/master/webpack.config.js](https://github.com/jdf2e/webpack4-demo/blob/master/webpack.config.js)

* **Webpack 4 和单页应用入门**
[https://github.com/fenivana/webpack-and-spa-guide](https://github.com/fenivana/webpack-and-spa-guide)
* **cross-env跨平台设置环境变量**

  [https://www.jianshu.com/p/696bd579f9ec](https://www.jianshu.com/p/696bd579f9ec)

  [https://www.cnblogs.com/yanze/p/7879631.html](https://www.cnblogs.com/yanze/p/7879631.html)

* **Postcss 配置**
[https://webpack.js.org/loaders/postcss-loader/#src/components/Sidebar/Sidebar.jsx](https://webpack.js.org/loaders/postcss-loader/#src/components/Sidebar/Sidebar.jsx)

* **Postcss preset env**
[https://github.com/csstools/postcss-preset-env](https://github.com/csstools/postcss-preset-env)

* **CSS Declaration Sorter**
[https://github.com/Siilwyn/css-declaration-sorter](https://github.com/Siilwyn/css-declaration-sorter)

* **css-mqpacker**
[https://github.com/hail2u/node-css-mqpacker](https://github.com/hail2u/node-css-mqpacker)

* **Fix image-webpack-loader bug**
[https://medium.com/gulpjs/gulp-util-ca3b1f9f9ac5](https://medium.com/gulpjs/gulp-util-ca3b1f9f9ac5)

* **按照报错解决办法**
```
Unexpected end of JSON input while parsing near '..."node":">=0.8.0"},"_h'
```
```
npm cache clean --force
```

* **官网的例子**
[https://github.com/webpack/webpack/tree/master/test/configCases](https://github.com/webpack/webpack/tree/master/test/configCases)

* **webpack配置react-hot-loader热加载局部更新**
[https://blog.csdn.net/huangpb123/article/details/78556652](https://blog.csdn.net/huangpb123/article/details/78556652)

[https://github.com/brickspert/blog/issues/1#hot-module-replacement]https://github.com/brickspert/blog/issues/1#hot-module-replacement)